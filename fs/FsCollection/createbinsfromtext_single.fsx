open System
open System.Linq
open System.IO
open System.Collections.Generic

let files = Directory.GetFiles(@"z:\kaggle\malware\test", "*.bytes")
let outPath = @"c:\kaggle\malware\test"

if not (Directory.Exists outPath) then Directory.CreateDirectory outPath |> ignore

let fl = @"Z:\Kaggle\Malware\test\NmX5U1li26VTxb3kySou.bytes"

let bytes = 
    File.ReadLines(fl)
        .SelectMany(
            fun l -> 
                l.Split([|' '|], 2)
                    .Last()
                    .Split(' ')
                    .Where(fun s -> System.Char.IsLetterOrDigit(s.[0]) && System.Char.IsLetterOrDigit(s.[1]))
                    .Select(fun s -> Convert.ToByte(s, 16)))
        .ToArray()
    
let outF = Path.ChangeExtension(Path.Combine(outPath, Path.GetFileName(fl)), ".bin")
File.WriteAllBytes(outF, bytes)