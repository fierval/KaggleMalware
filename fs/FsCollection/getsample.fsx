open System
open System.Linq
open System.IO
open System.Collections.Generic

let path = @"C:\kaggle\malware\scratchpad\train\mix_lbp_counts"
//let path = @"C:\kaggle\malware\train\presubmit"
//let path = @"c:\kaggle\malware\scratchpad\train\1dlbp"
//let path = @"c:\kaggle\malware\scrapbook\train"
//let outPath = @"c:\kaggle\malware\scrapbook\1dlbp\train"
//let outPath = @"c:\kaggle\malware\scrapbook\test"
let outPath = @"c:\kaggle\malware\scratchpad\test\mix_lbp_counts"
let fraction = 0.1
let except = true

Environment.CurrentDirectory <- path

if Directory.Exists outPath then 
    Directory.Delete (outPath, true)

Directory.CreateDirectory outPath

let rnd : Random = new Random (int DateTime.Now.Ticks)
let files = Directory.GetFiles(".").Where(fun f -> FileInfo(f).Length > 0L).ToArray()

let total = int (float files.Length * fraction)
let fileList : List<int> = new List<int>()

for i = 1 to total do
    let mutable nxt = rnd.Next(files.Length)
    
    while fileList.Contains nxt do
        nxt <- rnd.Next(files.Length)
    fileList.Add nxt

for i in fileList do
    if not except then
        File.Copy(files.[i], Path.Combine(outPath, Path.GetFileName(files.[i])))
    else
        File.Move(files.[i], Path.Combine(outPath, Path.GetFileName(files.[i])))
    
